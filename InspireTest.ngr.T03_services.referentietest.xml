<testsuite failures="1" name="InspireTest/ngr/T03_services/referentietest.feature" skipped="0" tests="1" time="41.777054">
  <testcase classname="InspireTest.ngr.T03_services.referentietest" name="Conformance Class: Download Service - Pre-defined Atom,  Atom Invasieve Exoten (INSPIRE Geharmoniseerd) https://geodata.nationaalgeoregister.nl/rvo/inspire/invasieve-exoten/atom/v1_0/index.xml EID11571c92-3940-4f42-a6cd-5e2b1c6f4d93" time="41.777054">
    <failure message="referentietest.feature:61 - evaluation (js) failed: response.EtfItemCollection.testRuns.TestRun.status, javax.script.ScriptException: TypeError: Cannot read property &quot;TestRun&quot; from undefined in &lt;eval&gt; at line number 1&#10;stack trace: jdk.scripting.nashorn/jdk.nashorn.api.scripting.NashornScriptEngine.throwAsScriptException(NashornScriptEngine.java:477)">* url 'https://inspire.ec.europa.eu/validator/v2/' ........................ passed
* def testRunRequest = .................................................... passed
Given path 'TestRuns' ..................................................... passed
And request testRunRequest ................................................ passed
When method post .......................................................... passed
Then assert responseStatus == 200 || responseStatus == 201 ................ passed
* print response.EtfItemCollection.testRuns.TestRun.id .................... passed
* print response.EtfItemCollection.testRuns.TestRun.status ................ passed
* print response.EtfItemCollection.testRuns.TestRun.label ................. passed
* print response.EtfItemCollection.ref .................................... passed
* print response.EtfItemCollection.testRuns.TestRun.logPath ............... passed
* def statuspath = "TestRuns/" + response.EtfItemCollection.testRuns.TestRun.id . passed
* def progresspath = "TestRuns/" + response.EtfItemCollection.testRuns.TestRun.id + "/progress" . passed
* print 'statuspath', statuspath .......................................... passed
* print 'progresspath ', progresspath ..................................... passed
Given path  progresspath .................................................. passed
When method GET ........................................................... passed
And retry until response.val == response.max .............................. passed
* print response .......................................................... passed
Given path  progresspath .................................................. passed
When method GET ........................................................... passed
* print response .......................................................... passed
Given path  statuspath .................................................... passed
When method GET ........................................................... passed
* print response.EtfItemCollection.testRuns.TestRun.id .................... passed
* print response.EtfItemCollection.testRuns.TestRun.status ................ passed
* def status = response.EtfItemCollection.testRuns.TestRun.status ......... failed

Stack Trace:
com.intuit.karate.exception.KarateException: referentietest.feature:61 - evaluation (js) failed: response.EtfItemCollection.testRuns.TestRun.status, javax.script.ScriptException: TypeError: Cannot read property "TestRun" from undefined in &lt;eval&gt; at line number 1
stack trace: jdk.scripting.nashorn/jdk.nashorn.api.scripting.NashornScriptEngine.throwAsScriptException(NashornScriptEngine.java:477)
	at âœ½.* def status = response.EtfItemCollection.testRuns.TestRun.status (referentietest.feature:61)

* print status ............................................................ skipped
* print response.EtfItemCollection.testRuns.TestRun.label ................. skipped
* print response.EtfItemCollection.ref .................................... skipped
* def ref = response.EtfItemCollection.ref ................................ skipped
* print ref ............................................................... skipped
* print response.EtfItemCollection.testRuns.TestRun.logPath ............... skipped
* def embedUrl = .......................................................... skipped
* def time = java.lang.System.currentTimeMillis() ......................... skipped
* def jsonPath = time + 'Conformance Class: Download Service - Pre-defined Atom,  Atom Invasieve Exoten (INSPIRE Geharmoniseerd).json' . skipped
* def responsecontent = response .......................................... skipped
* karate.write(responsecontent, jsonPath) ................................. skipped
* def a = embedUrl (ref.substring(0, ref.length - 5) + '.html' ,  status ) . skipped
* def a = embedUrl ("../../" + jsonPath ,  status ) ....................... skipped
* def json = get[0] response.EtfItemCollection.referencedItems.testTaskResults . skipped
* def jsonfailedStep = $json.TestTaskResult.testModuleResults.TestModuleResult[*].testCaseResults.TestCaseResult[*].testStepResults.TestStepResult[?(@.status=='FAILED')] . skipped
* def jsonFailedStepmessages = $jsonfailedStep[*].messages.message.ref .... skipped
* print jsonFailedStepmessages ............................................ skipped
* def jsonfailedAssert = $jsonfailedStep[*].testAssertionResults.TestAssertionResult[?(@.status=='FAILED')] . skipped
* def jsonfailedMessages = $jsonfailedAssert[*].messages.message .......... skipped
* def tmpref = $jsonfailedMessages[*].ref ................................. skipped
* def refs = karate.append( jsonFailedStepmessages, tmpref ) .............. skipped
* def expectedresult = read('classpath:InspireTest/ETFexpected/atomerror.json') . skipped
* def Collections = Java.type('java.util.Collections') .................... skipped
* copy sortedrefs = refs .................................................. skipped
* Collections.sort(sortedrefs) ............................................ skipped
* copy sortedexpectedrefs = $expectedresult[*].ref ........................ skipped
* Collections.sort(sortedexpectedrefs) .................................... skipped
* print refs .............................................................. skipped
* print sortedrefs ........................................................ skipped
* print sortedexpectedrefs ................................................ skipped
* match sortedrefs == sortedexpectedrefs .................................. skipped
* print jsonfailedMessages ................................................ skipped
* def tempdir = java.lang.System.getProperty('user.dir') .................. skipped
* def separator = java.lang.System.getProperty("file.separator") .......... skipped
* def outputpath = tempdir + separator + 'output' + separator ............. skipped
* def mystorage = Java.type('storage.DataStorage') ........................ skipped
* def db = new mystorage .................................................. skipped
* def LocalDateTime = Java.type('java.time.LocalDateTime') ................ skipped
* eval db.writeln('- Test: '+ karate.info.scenarioName+ '\n  Time: '+ LocalDateTime.now() +'\n  Errors: ' +  sortedrefs  ,  outputpath + karate.info.featureFileName + '.yaml') . skipped</failure>
  </testcase>
</testsuite>
